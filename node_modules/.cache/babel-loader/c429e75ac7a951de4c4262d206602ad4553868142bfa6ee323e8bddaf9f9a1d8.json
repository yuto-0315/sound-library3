{"ast":null,"code":"var _jsxFileName = \"/Users/nakataniyuutomo/Desktop/Programing/\\u30BB\\u3099\\u30DF\\u958B\\u767A/sound-library2/src/pages/SoundCollection.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { useState, useRef, useEffect } from 'react';\nimport './SoundCollection.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst SoundCollection = () => {\n  _s();\n  const [recordings, setRecordings] = useState([]);\n  const [isRecording, setIsRecording] = useState(false);\n  const [mediaRecorder, setMediaRecorder] = useState(null);\n  const [currentRecording, setCurrentRecording] = useState(null);\n  const [audioLevel, setAudioLevel] = useState(0);\n  const [audioContext, setAudioContext] = useState(null);\n  const fileInputRef = useRef(null);\n  const animationFrameRef = useRef(null);\n\n  // コンポーネントアンマウント時のクリーンアップ\n  useEffect(() => {\n    return () => {\n      // 録音中の場合は停止\n      if (mediaRecorder && isRecording) {\n        mediaRecorder.stop();\n        if (mediaRecorder.stream) {\n          mediaRecorder.stream.getTracks().forEach(track => track.stop());\n        }\n      }\n\n      // 作成されたBlobURLをクリーンアップ\n      recordings.forEach(recording => {\n        if (recording.url && recording.url.startsWith('blob:')) {\n          URL.revokeObjectURL(recording.url);\n        }\n      });\n    };\n  }, [mediaRecorder, isRecording, recordings]);\n  const startRecording = async () => {\n    try {\n      // iOSでのマイクアクセス改善 - まずテストを実行\n      const hasAccess = await testMicrophoneAccess();\n      if (!hasAccess) {\n        return;\n      }\n      console.log('録音開始処理中...');\n\n      // iPad用の音声設定を最適化\n      const audioConstraints = {\n        echoCancellation: false,\n        // iPadでは無効にする\n        noiseSuppression: false,\n        // iPadでは無効にする  \n        autoGainControl: false,\n        // iPadでは無効にする\n        sampleRate: 44100,\n        // 明示的にサンプルレートを指定\n        channelCount: 1 // モノラル録音を明示\n      };\n      console.log('音声制約:', audioConstraints);\n      const stream = await navigator.mediaDevices.getUserMedia({\n        audio: audioConstraints\n      });\n      console.log('録音ストリーム取得成功');\n      console.log('ストリーム詳細:', {\n        id: stream.id,\n        active: stream.active,\n        tracks: stream.getTracks().map(track => ({\n          id: track.id,\n          kind: track.kind,\n          label: track.label,\n          enabled: track.enabled,\n          muted: track.muted,\n          readyState: track.readyState,\n          settings: track.getSettings ? track.getSettings() : 'getSettings not supported'\n        }))\n      });\n\n      // 音声レベル監視のためのAudioContextを設定\n      const audioCtx = new (window.AudioContext || window.webkitAudioContext)();\n      console.log('AudioContext作成:', {\n        state: audioCtx.state,\n        sampleRate: audioCtx.sampleRate,\n        baseLatency: audioCtx.baseLatency\n      });\n\n      // AudioContextが停止している場合は再開\n      if (audioCtx.state === 'suspended') {\n        console.log('AudioContextを再開中...');\n        await audioCtx.resume();\n        console.log('AudioContext再開完了:', audioCtx.state);\n      }\n      const source = audioCtx.createMediaStreamSource(stream);\n      const analyserNode = audioCtx.createAnalyser();\n      analyserNode.fftSize = 256;\n      analyserNode.smoothingTimeConstant = 0.8; // スムージングを追加\n      source.connect(analyserNode);\n      console.log('AudioContext接続完了:', {\n        analyserFFTSize: analyserNode.fftSize,\n        frequencyBinCount: analyserNode.frequencyBinCount,\n        smoothingTimeConstant: analyserNode.smoothingTimeConstant\n      });\n      setAudioContext(audioCtx);\n\n      // 音声レベル監視開始\n      monitorAudioLevel(analyserNode);\n\n      // MediaRecorderのオプションを決定\n      let recorderOptions = {};\n      if (MediaRecorder.isTypeSupported('audio/webm;codecs=opus')) {\n        recorderOptions.mimeType = 'audio/webm;codecs=opus';\n        console.log('使用するMIMEタイプ: audio/webm;codecs=opus');\n      } else if (MediaRecorder.isTypeSupported('audio/mp4')) {\n        recorderOptions.mimeType = 'audio/mp4';\n        console.log('使用するMIMEタイプ: audio/mp4');\n      } else if (MediaRecorder.isTypeSupported('audio/wav')) {\n        recorderOptions.mimeType = 'audio/wav';\n        console.log('使用するMIMEタイプ: audio/wav');\n      } else {\n        console.log('デフォルトMIMEタイプを使用');\n      }\n      const recorder = new MediaRecorder(stream, recorderOptions);\n      console.log('MediaRecorder作成:', {\n        mimeType: recorder.mimeType,\n        state: recorder.state,\n        supportedTypes: {\n          'audio/webm;codecs=opus': MediaRecorder.isTypeSupported('audio/webm;codecs=opus'),\n          'audio/mp4': MediaRecorder.isTypeSupported('audio/mp4'),\n          'audio/wav': MediaRecorder.isTypeSupported('audio/wav')\n        }\n      });\n      const chunks = [];\n      recorder.ondataavailable = e => {\n        console.log('録音データ受信:', e.data.size, 'bytes, type:', e.data.type);\n        chunks.push(e.data);\n      };\n      recorder.onstop = () => {\n        const blob = new Blob(chunks, {\n          type: 'audio/wav'\n        });\n        const url = URL.createObjectURL(blob);\n        console.log('録音完了 - Blobサイズ:', blob.size, 'bytes, type:', blob.type);\n        console.log('チャンク数:', chunks.length, 'chunks');\n        setCurrentRecording({\n          id: Date.now(),\n          url: url,\n          audioBlob: blob,\n          name: '',\n          tags: [],\n          createdAt: new Date()\n        });\n\n        // 音声レベル監視停止\n        setAudioLevel(0);\n        if (animationFrameRef.current) {\n          cancelAnimationFrame(animationFrameRef.current);\n        }\n      };\n      recorder.start();\n      console.log('録音開始:', recorder.state);\n      setMediaRecorder(recorder);\n      setIsRecording(true);\n      console.log('録音開始完了');\n    } catch (error) {\n      console.error('録音の開始に失敗しました:', error);\n      let errorMessage = '録音を開始できませんでした。';\n      if (error.name === 'NotAllowedError') {\n        errorMessage = 'マイクの使用が拒否されました。ブラウザの設定でマイクアクセスを許可してください。';\n      } else if (error.name === 'NotFoundError') {\n        errorMessage = 'マイクが見つかりません。デバイスにマイクが接続されているか確認してください。';\n      } else if (error.name === 'NotSupportedError') {\n        errorMessage = 'お使いのブラウザは録音機能をサポートしていません。';\n      } else if (error.name === 'NotReadableError') {\n        errorMessage = 'マイクが他のアプリケーションで使用中の可能性があります。';\n      } else if (error.message) {\n        errorMessage = error.message;\n      }\n      alert(errorMessage);\n    }\n  };\n  const stopRecording = () => {\n    if (mediaRecorder) {\n      mediaRecorder.stop();\n      mediaRecorder.stream.getTracks().forEach(track => track.stop());\n      setIsRecording(false);\n      setMediaRecorder(null);\n    }\n\n    // 音声レベル監視を停止\n    setAudioLevel(0);\n    if (animationFrameRef.current) {\n      cancelAnimationFrame(animationFrameRef.current);\n    }\n\n    // AudioContextをクリーンアップ\n    if (audioContext && audioContext.state !== 'closed') {\n      audioContext.close().catch(error => {\n        console.warn('SoundCollection AudioContext のクローズに失敗:', error);\n      });\n      setAudioContext(null);\n    }\n  };\n\n  // Blobを Base64 に変換する関数\n  const blobToBase64 = blob => {\n    return new Promise((resolve, reject) => {\n      const reader = new FileReader();\n      reader.onload = () => resolve(reader.result);\n      reader.onerror = reject;\n      reader.readAsDataURL(blob);\n    });\n  };\n  const saveRecording = async (name, tags) => {\n    if (currentRecording && name.trim()) {\n      try {\n        // Blobをbase64に変換\n        const base64Data = await blobToBase64(currentRecording.audioBlob);\n        const savedRecording = {\n          ...currentRecording,\n          name: name.trim(),\n          tags: tags.filter(tag => tag.trim()).map(tag => tag.trim()),\n          audioData: base64Data,\n          // base64データを保存\n          // audioBlobは一時的なものなので削除\n          audioBlob: undefined\n        };\n        setRecordings([...recordings, savedRecording]);\n        setCurrentRecording(null);\n\n        // LocalStorageに保存（audioBlobは除外）\n        const existingRecordings = JSON.parse(localStorage.getItem('soundRecordings') || '[]');\n        const recordingToSave = {\n          ...savedRecording\n        };\n        delete recordingToSave.audioBlob; // Blobは保存しない\n        localStorage.setItem('soundRecordings', JSON.stringify([...existingRecordings, recordingToSave]));\n      } catch (error) {\n        console.error('録音の保存に失敗しました:', error);\n        alert('録音の保存に失敗しました。再度お試しください。');\n      }\n    }\n  };\n  const handleFileUpload = event => {\n    const file = event.target.files[0];\n    if (file && file.type.startsWith('audio/')) {\n      const url = URL.createObjectURL(file);\n      setCurrentRecording({\n        id: Date.now(),\n        url: url,\n        audioBlob: file,\n        name: file.name.replace(/\\.[^/.]+$/, ''),\n        tags: [],\n        createdAt: new Date()\n      });\n    }\n  };\n\n  // マイクアクセステスト機能（iOSでの問題対策）\n  const testMicrophoneAccess = async () => {\n    try {\n      console.log('マイクアクセステスト開始');\n\n      // HTTPS接続チェック\n      if (!checkHTTPS()) {\n        alert('🔒 録音機能を使用するにはHTTPS接続が必要です。\\n\\niPhoneでは特に、セキュアな接続が必要となります。');\n        return false;\n      }\n      if (!navigator.mediaDevices || !navigator.mediaDevices.getUserMedia) {\n        throw new Error('お使いのブラウザは録音機能をサポートしていません。');\n      }\n\n      // まずマイクの権限状態を確認\n      if (navigator.permissions) {\n        try {\n          const permission = await navigator.permissions.query({\n            name: 'microphone'\n          });\n          console.log('マイク権限状態:', permission.state);\n          if (permission.state === 'denied') {\n            alert('マイクアクセスが拒否されています。ブラウザの設定からマイクの使用を許可してください。');\n            return false;\n          }\n        } catch (permError) {\n          console.log('権限確認はサポートされていません:', permError);\n        }\n      }\n\n      // 実際にマイクアクセスをテスト\n      const stream = await navigator.mediaDevices.getUserMedia({\n        audio: {\n          echoCancellation: true,\n          noiseSuppression: true,\n          autoGainControl: true\n        }\n      });\n\n      // すぐにストリームを停止\n      stream.getTracks().forEach(track => track.stop());\n      console.log('マイクアクセステスト成功');\n      return true;\n    } catch (error) {\n      console.error('マイクアクセステスト失敗:', error);\n      let errorMessage = 'マイクにアクセスできません。';\n      if (error.name === 'NotAllowedError') {\n        errorMessage = 'マイクの使用が拒否されました。ブラウザの設定でマイクアクセスを許可してください。\\n\\niPhoneの場合：\\n1. Safari設定 > プライバシーとセキュリティ > マイク\\n2. このサイトを許可に設定';\n      } else if (error.name === 'NotFoundError') {\n        errorMessage = 'マイクが見つかりません。';\n      } else if (error.name === 'NotSupportedError') {\n        errorMessage = 'お使いのブラウザは録音機能をサポートしていません。';\n      } else if (error.message) {\n        errorMessage = error.message;\n      }\n      alert(errorMessage);\n      return false;\n    }\n  };\n\n  // HTTPS接続チェック（iOSでの録音に必要）\n  const checkHTTPS = () => {\n    if (window.location.protocol !== 'https:' && window.location.hostname !== 'localhost' && window.location.hostname !== '127.0.0.1') {\n      return false;\n    }\n    return true;\n  };\n\n  // 音声レベル監視関数\n  const monitorAudioLevel = analyserNode => {\n    const bufferLength = analyserNode.frequencyBinCount;\n    const dataArray = new Uint8Array(bufferLength);\n    console.log('音声レベル監視開始 - bufferLength:', bufferLength);\n    const updateLevel = () => {\n      if (!isRecording) {\n        console.log('録音停止のため音声レベル監視終了');\n        return;\n      }\n\n      // 時間領域データを取得（周波数領域ではなく）\n      analyserNode.getByteTimeDomainData(dataArray);\n\n      // デバッグ用：最初の10サンプルをログ出力（最初の数秒のみ）\n      if (Math.random() < 0.01) {\n        // 1%の確率でログ出力\n        console.log('音声データサンプル:', Array.from(dataArray.slice(0, 10)));\n      }\n\n      // RMS（二乗平均平方根）を計算\n      let sum = 0;\n      for (let i = 0; i < bufferLength; i++) {\n        const sample = (dataArray[i] - 128) / 128; // -1 to 1の範囲に正規化\n        sum += sample * sample;\n      }\n      const rms = Math.sqrt(sum / bufferLength);\n\n      // デシベルに変換して0-100の範囲にマッピング\n      const db = 20 * Math.log10(rms + 0.0001); // 0.0001は-∞を防ぐため\n      const level = Math.max(0, Math.min(100, (db + 60) / 60 * 100)); // -60dBを0%、0dBを100%に\n\n      // デバッグ用：レベルをログ出力（時々）\n      if (Math.random() < 0.01) {\n        // 1%の確率でログ出力\n        console.log('音声レベル - RMS:', rms, 'dB:', db, 'Level:', level);\n      }\n      setAudioLevel(level);\n      if (isRecording) {\n        animationFrameRef.current = requestAnimationFrame(updateLevel);\n      }\n    };\n    updateLevel();\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"sound-collection\",\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: \"\\uD83C\\uDFA4 \\u97F3\\u3042\\u3064\\u3081\\u30DA\\u30FC\\u30B8\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 388,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      children: \"\\u8EAB\\u306E\\u56DE\\u308A\\u306B\\u3042\\u308B\\u97F3\\u3092\\u9332\\u97F3\\u3057\\u305F\\u308A\\u3001\\u97F3\\u30D5\\u30A1\\u30A4\\u30EB\\u3092\\u30A2\\u30C3\\u30D7\\u30ED\\u30FC\\u30C9\\u3057\\u3066\\u97F3\\u7D20\\u6750\\u3092\\u96C6\\u3081\\u307E\\u3057\\u3087\\u3046\\uFF01\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 389,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"collection-actions\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"recording-section card\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          children: \"\\uD83C\\uDF99\\uFE0F \\u97F3\\u3092\\u9332\\u97F3\\u3059\\u308B\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 393,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"ios-notice\",\n          children: [/*#__PURE__*/_jsxDEV(\"p\", {\n            children: [\"\\uD83D\\uDCF1 \", /*#__PURE__*/_jsxDEV(\"strong\", {\n              children: \"iPhone/iPad\\u3092\\u304A\\u4F7F\\u3044\\u306E\\u65B9\\u3078\\uFF1A\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 397,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 397,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"\\u9332\\u97F3\\u30DC\\u30BF\\u30F3\\u3092\\u62BC\\u3059\\u3068\\u30DE\\u30A4\\u30AF\\u306E\\u4F7F\\u7528\\u8A31\\u53EF\\u3092\\u6C42\\u3081\\u308B\\u30C0\\u30A4\\u30A2\\u30ED\\u30B0\\u304C\\u8868\\u793A\\u3055\\u308C\\u307E\\u3059\\u3002\\u300C\\u8A31\\u53EF\\u300D\\u3092\\u9078\\u629E\\u3057\\u3066\\u304F\\u3060\\u3055\\u3044\\u3002\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 398,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"\\u30C0\\u30A4\\u30A2\\u30ED\\u30B0\\u304C\\u8868\\u793A\\u3055\\u308C\\u306A\\u3044\\u5834\\u5408\\u306F\\u3001Safari\\u8A2D\\u5B9A \\u2192 \\u30D7\\u30E9\\u30A4\\u30D0\\u30B7\\u30FC\\u3068\\u30BB\\u30AD\\u30E5\\u30EA\\u30C6\\u30A3 \\u2192 \\u30DE\\u30A4\\u30AF \\u3067\\u3053\\u306E\\u30B5\\u30A4\\u30C8\\u3092\\u8A31\\u53EF\\u3057\\u3066\\u304F\\u3060\\u3055\\u3044\\u3002\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 399,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 396,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"recording-controls\",\n          children: !isRecording ? /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"button-primary large-button record-btn\",\n            onClick: startRecording,\n            children: \"\\uD83D\\uDD34 \\u9332\\u97F3\\u958B\\u59CB\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 404,\n            columnNumber: 15\n          }, this) : /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"button-secondary large-button stop-btn\",\n            onClick: stopRecording,\n            children: \"\\u23F9\\uFE0F \\u9332\\u97F3\\u505C\\u6B62\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 411,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 402,\n          columnNumber: 11\n        }, this), isRecording && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"recording-status\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"recording-indicator\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"pulse-dot\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 422,\n              columnNumber: 17\n            }, this), \"\\u9332\\u97F3\\u4E2D...\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 421,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"audio-level-meter\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"audio-level-label\",\n              children: \"\\u97F3\\u58F0\\u5165\\u529B\\u30EC\\u30D9\\u30EB:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 426,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"audio-level-bar\",\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"audio-level-fill\",\n                style: {\n                  width: `${audioLevel}%`\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 428,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 427,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"audio-level-value\",\n              children: [Math.round(audioLevel), \"%\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 433,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 425,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 420,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 392,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"upload-section card\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          children: \"\\uD83D\\uDCC1 \\u97F3\\u30D5\\u30A1\\u30A4\\u30EB\\u3092\\u30A2\\u30C3\\u30D7\\u30ED\\u30FC\\u30C9\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 440,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"button-secondary large-button\",\n          onClick: () => {\n            var _fileInputRef$current;\n            return (_fileInputRef$current = fileInputRef.current) === null || _fileInputRef$current === void 0 ? void 0 : _fileInputRef$current.click();\n          },\n          children: \"\\uD83D\\uDCC2 \\u30D5\\u30A1\\u30A4\\u30EB\\u3092\\u9078\\u629E\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 441,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          ref: fileInputRef,\n          type: \"file\",\n          accept: \"audio/*\",\n          onChange: handleFileUpload,\n          style: {\n            display: 'none'\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 447,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 439,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 391,\n      columnNumber: 7\n    }, this), currentRecording && /*#__PURE__*/_jsxDEV(RecordingEditor, {\n      recording: currentRecording,\n      onSave: saveRecording,\n      onCancel: () => setCurrentRecording(null)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 458,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"recent-recordings\",\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        children: \"\\uD83D\\uDCDD \\u6700\\u8FD1\\u9332\\u97F3\\u3057\\u305F\\u97F3\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 466,\n        columnNumber: 9\n      }, this), recordings.length === 0 ? /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"no-recordings\",\n        children: \"\\u307E\\u3060\\u9332\\u97F3\\u3057\\u305F\\u97F3\\u304C\\u3042\\u308A\\u307E\\u305B\\u3093\\u3002\\u4E0A\\u306E\\u9332\\u97F3\\u30DC\\u30BF\\u30F3\\u304B\\u3089\\u59CB\\u3081\\u307E\\u3057\\u3087\\u3046\\uFF01\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 468,\n        columnNumber: 11\n      }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"recordings-grid\",\n        children: recordings.map(recording => /*#__PURE__*/_jsxDEV(SoundCard, {\n          recording: recording\n        }, recording.id, false, {\n          fileName: _jsxFileName,\n          lineNumber: 472,\n          columnNumber: 15\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 470,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 465,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 387,\n    columnNumber: 5\n  }, this);\n};\n_s(SoundCollection, \"VILI2bSPoWmM5C4KN42qAUI/YJ4=\");\n_c = SoundCollection;\nconst RecordingEditor = ({\n  recording,\n  onSave,\n  onCancel\n}) => {\n  _s2();\n  const [name, setName] = useState(recording.name);\n  const [tagInput, setTagInput] = useState('');\n  const [tags, setTags] = useState(recording.tags);\n  const addTag = () => {\n    if (tagInput.trim() && !tags.includes(tagInput.trim())) {\n      setTags([...tags, tagInput.trim()]);\n      setTagInput('');\n    }\n  };\n  const removeTag = tagToRemove => {\n    setTags(tags.filter(tag => tag !== tagToRemove));\n  };\n  const handleKeyPress = e => {\n    if (e.key === 'Enter') {\n      addTag();\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"recording-editor card\",\n    children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n      children: \"\\u270F\\uFE0F \\u97F3\\u306B\\u540D\\u524D\\u3092\\u3064\\u3051\\u3088\\u3046\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 505,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"audio\", {\n      controls: true,\n      src: recording.url,\n      className: \"audio-preview\",\n      onError: e => {\n        console.error('音声プレビューの読み込みエラー:', e);\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 507,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"form-group\",\n      children: [/*#__PURE__*/_jsxDEV(\"label\", {\n        htmlFor: \"soundName\",\n        children: \"\\u97F3\\u306E\\u540D\\u524D:\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 517,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        id: \"soundName\",\n        type: \"text\",\n        value: name,\n        onChange: e => setName(e.target.value),\n        placeholder: \"\\u4F8B: \\u30D4\\u30A2\\u30CE\\u306E\\u97F3\\u3001\\u96E8\\u306E\\u97F3\",\n        className: \"sound-name-input\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 518,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 516,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"form-group\",\n      children: [/*#__PURE__*/_jsxDEV(\"label\", {\n        htmlFor: \"soundTags\",\n        children: \"\\u30BF\\u30B0:\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 529,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"tag-input-container\",\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          id: \"soundTags\",\n          type: \"text\",\n          value: tagInput,\n          onChange: e => setTagInput(e.target.value),\n          onKeyPress: handleKeyPress,\n          placeholder: \"\\u4F8B: \\u697D\\u5668\\u3001\\u81EA\\u7136\",\n          className: \"tag-input\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 531,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: addTag,\n          className: \"add-tag-btn\",\n          children: \"\\u8FFD\\u52A0\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 540,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 530,\n        columnNumber: 9\n      }, this), tags.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"tags-display\",\n        children: tags.map(tag => /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"tag\",\n          children: [tag, /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => removeTag(tag),\n            className: \"remove-tag\",\n            children: \"\\xD7\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 548,\n            columnNumber: 17\n          }, this)]\n        }, tag, true, {\n          fileName: _jsxFileName,\n          lineNumber: 546,\n          columnNumber: 15\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 544,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 528,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"editor-actions\",\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => onSave(name, tags),\n        className: \"button-primary\",\n        disabled: !name.trim(),\n        children: \"\\uD83D\\uDCBE \\u4FDD\\u5B58\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 556,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: onCancel,\n        className: \"button-secondary\",\n        children: \"\\u274C \\u30AD\\u30E3\\u30F3\\u30BB\\u30EB\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 563,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 555,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 504,\n    columnNumber: 5\n  }, this);\n};\n_s2(RecordingEditor, \"a0E/AsiW4tjCFywrhs6E4x6cEY4=\");\n_c2 = RecordingEditor;\nconst SoundCard = ({\n  recording\n}) => {\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"sound-card\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"sound-info\",\n      children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n        children: recording.name\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 575,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"sound-date\",\n        children: new Date(recording.createdAt).toLocaleDateString('ja-JP')\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 576,\n        columnNumber: 9\n      }, this), recording.tags.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"sound-tags\",\n        children: recording.tags.map(tag => /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"tag small\",\n          children: tag\n        }, tag, false, {\n          fileName: _jsxFileName,\n          lineNumber: 582,\n          columnNumber: 15\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 580,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 574,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"audio\", {\n      controls: true,\n      src: recording.url,\n      onError: e => {\n        console.error('音声カードの読み込みエラー:', e, 'recording:', recording.name);\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 587,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 573,\n    columnNumber: 5\n  }, this);\n};\n_c3 = SoundCard;\nexport default SoundCollection;\nvar _c, _c2, _c3;\n$RefreshReg$(_c, \"SoundCollection\");\n$RefreshReg$(_c2, \"RecordingEditor\");\n$RefreshReg$(_c3, \"SoundCard\");","map":{"version":3,"names":["React","useState","useRef","useEffect","jsxDEV","_jsxDEV","SoundCollection","_s","recordings","setRecordings","isRecording","setIsRecording","mediaRecorder","setMediaRecorder","currentRecording","setCurrentRecording","audioLevel","setAudioLevel","audioContext","setAudioContext","fileInputRef","animationFrameRef","stop","stream","getTracks","forEach","track","recording","url","startsWith","URL","revokeObjectURL","startRecording","hasAccess","testMicrophoneAccess","console","log","audioConstraints","echoCancellation","noiseSuppression","autoGainControl","sampleRate","channelCount","navigator","mediaDevices","getUserMedia","audio","id","active","tracks","map","kind","label","enabled","muted","readyState","settings","getSettings","audioCtx","window","AudioContext","webkitAudioContext","state","baseLatency","resume","source","createMediaStreamSource","analyserNode","createAnalyser","fftSize","smoothingTimeConstant","connect","analyserFFTSize","frequencyBinCount","monitorAudioLevel","recorderOptions","MediaRecorder","isTypeSupported","mimeType","recorder","supportedTypes","chunks","ondataavailable","e","data","size","type","push","onstop","blob","Blob","createObjectURL","length","Date","now","audioBlob","name","tags","createdAt","current","cancelAnimationFrame","start","error","errorMessage","message","alert","stopRecording","close","catch","warn","blobToBase64","Promise","resolve","reject","reader","FileReader","onload","result","onerror","readAsDataURL","saveRecording","trim","base64Data","savedRecording","filter","tag","audioData","undefined","existingRecordings","JSON","parse","localStorage","getItem","recordingToSave","setItem","stringify","handleFileUpload","event","file","target","files","replace","checkHTTPS","Error","permissions","permission","query","permError","location","protocol","hostname","bufferLength","dataArray","Uint8Array","updateLevel","getByteTimeDomainData","Math","random","Array","from","slice","sum","i","sample","rms","sqrt","db","log10","level","max","min","requestAnimationFrame","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onClick","style","width","round","_fileInputRef$current","click","ref","accept","onChange","display","RecordingEditor","onSave","onCancel","SoundCard","_c","_s2","setName","tagInput","setTagInput","setTags","addTag","includes","removeTag","tagToRemove","handleKeyPress","key","controls","src","onError","htmlFor","value","placeholder","onKeyPress","disabled","_c2","toLocaleDateString","_c3","$RefreshReg$"],"sources":["/Users/nakataniyuutomo/Desktop/Programing/ゼミ開発/sound-library2/src/pages/SoundCollection.js"],"sourcesContent":["import React, { useState, useRef, useEffect } from 'react';\nimport './SoundCollection.css';\n\nconst SoundCollection = () => {\n  const [recordings, setRecordings] = useState([]);\n  const [isRecording, setIsRecording] = useState(false);\n  const [mediaRecorder, setMediaRecorder] = useState(null);\n  const [currentRecording, setCurrentRecording] = useState(null);\n  const [audioLevel, setAudioLevel] = useState(0);\n  const [audioContext, setAudioContext] = useState(null);\n  const fileInputRef = useRef(null);\n  const animationFrameRef = useRef(null);\n\n  // コンポーネントアンマウント時のクリーンアップ\n  useEffect(() => {\n    return () => {\n      // 録音中の場合は停止\n      if (mediaRecorder && isRecording) {\n        mediaRecorder.stop();\n        if (mediaRecorder.stream) {\n          mediaRecorder.stream.getTracks().forEach(track => track.stop());\n        }\n      }\n      \n      // 作成されたBlobURLをクリーンアップ\n      recordings.forEach(recording => {\n        if (recording.url && recording.url.startsWith('blob:')) {\n          URL.revokeObjectURL(recording.url);\n        }\n      });\n    };\n  }, [mediaRecorder, isRecording, recordings]);\n\n  const startRecording = async () => {\n    try {\n      // iOSでのマイクアクセス改善 - まずテストを実行\n      const hasAccess = await testMicrophoneAccess();\n      if (!hasAccess) {\n        return;\n      }\n\n      console.log('録音開始処理中...');\n      \n      // iPad用の音声設定を最適化\n      const audioConstraints = {\n        echoCancellation: false, // iPadでは無効にする\n        noiseSuppression: false, // iPadでは無効にする  \n        autoGainControl: false,  // iPadでは無効にする\n        sampleRate: 44100,       // 明示的にサンプルレートを指定\n        channelCount: 1          // モノラル録音を明示\n      };\n      \n      console.log('音声制約:', audioConstraints);\n      \n      const stream = await navigator.mediaDevices.getUserMedia({ \n        audio: audioConstraints\n      });\n      \n      console.log('録音ストリーム取得成功');\n      console.log('ストリーム詳細:', {\n        id: stream.id,\n        active: stream.active,\n        tracks: stream.getTracks().map(track => ({\n          id: track.id,\n          kind: track.kind,\n          label: track.label,\n          enabled: track.enabled,\n          muted: track.muted,\n          readyState: track.readyState,\n          settings: track.getSettings ? track.getSettings() : 'getSettings not supported'\n        }))\n      });\n      \n      // 音声レベル監視のためのAudioContextを設定\n      const audioCtx = new (window.AudioContext || window.webkitAudioContext)();\n      console.log('AudioContext作成:', {\n        state: audioCtx.state,\n        sampleRate: audioCtx.sampleRate,\n        baseLatency: audioCtx.baseLatency\n      });\n      \n      // AudioContextが停止している場合は再開\n      if (audioCtx.state === 'suspended') {\n        console.log('AudioContextを再開中...');\n        await audioCtx.resume();\n        console.log('AudioContext再開完了:', audioCtx.state);\n      }\n      \n      const source = audioCtx.createMediaStreamSource(stream);\n      const analyserNode = audioCtx.createAnalyser();\n      analyserNode.fftSize = 256;\n      analyserNode.smoothingTimeConstant = 0.8; // スムージングを追加\n      source.connect(analyserNode);\n      \n      console.log('AudioContext接続完了:', {\n        analyserFFTSize: analyserNode.fftSize,\n        frequencyBinCount: analyserNode.frequencyBinCount,\n        smoothingTimeConstant: analyserNode.smoothingTimeConstant\n      });\n      \n      setAudioContext(audioCtx);\n      \n      // 音声レベル監視開始\n      monitorAudioLevel(analyserNode);\n      \n      // MediaRecorderのオプションを決定\n      let recorderOptions = {};\n      \n      if (MediaRecorder.isTypeSupported('audio/webm;codecs=opus')) {\n        recorderOptions.mimeType = 'audio/webm;codecs=opus';\n        console.log('使用するMIMEタイプ: audio/webm;codecs=opus');\n      } else if (MediaRecorder.isTypeSupported('audio/mp4')) {\n        recorderOptions.mimeType = 'audio/mp4';\n        console.log('使用するMIMEタイプ: audio/mp4');\n      } else if (MediaRecorder.isTypeSupported('audio/wav')) {\n        recorderOptions.mimeType = 'audio/wav';\n        console.log('使用するMIMEタイプ: audio/wav');\n      } else {\n        console.log('デフォルトMIMEタイプを使用');\n      }\n      \n      const recorder = new MediaRecorder(stream, recorderOptions);\n      console.log('MediaRecorder作成:', {\n        mimeType: recorder.mimeType,\n        state: recorder.state,\n        supportedTypes: {\n          'audio/webm;codecs=opus': MediaRecorder.isTypeSupported('audio/webm;codecs=opus'),\n          'audio/mp4': MediaRecorder.isTypeSupported('audio/mp4'),\n          'audio/wav': MediaRecorder.isTypeSupported('audio/wav')\n        }\n      });\n      \n      const chunks = [];\n\n      recorder.ondataavailable = (e) => {\n        console.log('録音データ受信:', e.data.size, 'bytes, type:', e.data.type);\n        chunks.push(e.data);\n      };\n\n      recorder.onstop = () => {\n        const blob = new Blob(chunks, { type: 'audio/wav' });\n        const url = URL.createObjectURL(blob);\n        console.log('録音完了 - Blobサイズ:', blob.size, 'bytes, type:', blob.type);\n        console.log('チャンク数:', chunks.length, 'chunks');\n        setCurrentRecording({\n          id: Date.now(),\n          url: url,\n          audioBlob: blob,\n          name: '',\n          tags: [],\n          createdAt: new Date()\n        });\n        \n        // 音声レベル監視停止\n        setAudioLevel(0);\n        if (animationFrameRef.current) {\n          cancelAnimationFrame(animationFrameRef.current);\n        }\n      };\n\n      recorder.start();\n      console.log('録音開始:', recorder.state);\n      setMediaRecorder(recorder);\n      setIsRecording(true);\n      console.log('録音開始完了');\n      \n    } catch (error) {\n      console.error('録音の開始に失敗しました:', error);\n      \n      let errorMessage = '録音を開始できませんでした。';\n      \n      if (error.name === 'NotAllowedError') {\n        errorMessage = 'マイクの使用が拒否されました。ブラウザの設定でマイクアクセスを許可してください。';\n      } else if (error.name === 'NotFoundError') {\n        errorMessage = 'マイクが見つかりません。デバイスにマイクが接続されているか確認してください。';\n      } else if (error.name === 'NotSupportedError') {\n        errorMessage = 'お使いのブラウザは録音機能をサポートしていません。';\n      } else if (error.name === 'NotReadableError') {\n        errorMessage = 'マイクが他のアプリケーションで使用中の可能性があります。';\n      } else if (error.message) {\n        errorMessage = error.message;\n      }\n      \n      alert(errorMessage);\n    }\n  };\n\n  const stopRecording = () => {\n    if (mediaRecorder) {\n      mediaRecorder.stop();\n      mediaRecorder.stream.getTracks().forEach(track => track.stop());\n      setIsRecording(false);\n      setMediaRecorder(null);\n    }\n    \n    // 音声レベル監視を停止\n    setAudioLevel(0);\n    if (animationFrameRef.current) {\n      cancelAnimationFrame(animationFrameRef.current);\n    }\n    \n    // AudioContextをクリーンアップ\n    if (audioContext && audioContext.state !== 'closed') {\n      audioContext.close().catch(error => {\n        console.warn('SoundCollection AudioContext のクローズに失敗:', error);\n      });\n      setAudioContext(null);\n    }\n  };\n\n  // Blobを Base64 に変換する関数\n  const blobToBase64 = (blob) => {\n    return new Promise((resolve, reject) => {\n      const reader = new FileReader();\n      reader.onload = () => resolve(reader.result);\n      reader.onerror = reject;\n      reader.readAsDataURL(blob);\n    });\n  };\n\n  const saveRecording = async (name, tags) => {\n    if (currentRecording && name.trim()) {\n      try {\n        // Blobをbase64に変換\n        const base64Data = await blobToBase64(currentRecording.audioBlob);\n        \n        const savedRecording = {\n          ...currentRecording,\n          name: name.trim(),\n          tags: tags.filter(tag => tag.trim()).map(tag => tag.trim()),\n          audioData: base64Data, // base64データを保存\n          // audioBlobは一時的なものなので削除\n          audioBlob: undefined\n        };\n        \n        setRecordings([...recordings, savedRecording]);\n        setCurrentRecording(null);\n        \n        // LocalStorageに保存（audioBlobは除外）\n        const existingRecordings = JSON.parse(localStorage.getItem('soundRecordings') || '[]');\n        const recordingToSave = { ...savedRecording };\n        delete recordingToSave.audioBlob; // Blobは保存しない\n        localStorage.setItem('soundRecordings', JSON.stringify([...existingRecordings, recordingToSave]));\n      } catch (error) {\n        console.error('録音の保存に失敗しました:', error);\n        alert('録音の保存に失敗しました。再度お試しください。');\n      }\n    }\n  };\n\n  const handleFileUpload = (event) => {\n    const file = event.target.files[0];\n    if (file && file.type.startsWith('audio/')) {\n      const url = URL.createObjectURL(file);\n      setCurrentRecording({\n        id: Date.now(),\n        url: url,\n        audioBlob: file,\n        name: file.name.replace(/\\.[^/.]+$/, ''),\n        tags: [],\n        createdAt: new Date()\n      });\n    }\n  };\n\n  // マイクアクセステスト機能（iOSでの問題対策）\n  const testMicrophoneAccess = async () => {\n    try {\n      console.log('マイクアクセステスト開始');\n      \n      // HTTPS接続チェック\n      if (!checkHTTPS()) {\n        alert('🔒 録音機能を使用するにはHTTPS接続が必要です。\\n\\niPhoneでは特に、セキュアな接続が必要となります。');\n        return false;\n      }\n      \n      if (!navigator.mediaDevices || !navigator.mediaDevices.getUserMedia) {\n        throw new Error('お使いのブラウザは録音機能をサポートしていません。');\n      }\n\n      // まずマイクの権限状態を確認\n      if (navigator.permissions) {\n        try {\n          const permission = await navigator.permissions.query({ name: 'microphone' });\n          console.log('マイク権限状態:', permission.state);\n          \n          if (permission.state === 'denied') {\n            alert('マイクアクセスが拒否されています。ブラウザの設定からマイクの使用を許可してください。');\n            return false;\n          }\n        } catch (permError) {\n          console.log('権限確認はサポートされていません:', permError);\n        }\n      }\n\n      // 実際にマイクアクセスをテスト\n      const stream = await navigator.mediaDevices.getUserMedia({ \n        audio: {\n          echoCancellation: true,\n          noiseSuppression: true,\n          autoGainControl: true\n        }\n      });\n      \n      // すぐにストリームを停止\n      stream.getTracks().forEach(track => track.stop());\n      console.log('マイクアクセステスト成功');\n      return true;\n      \n    } catch (error) {\n      console.error('マイクアクセステスト失敗:', error);\n      \n      let errorMessage = 'マイクにアクセスできません。';\n      \n      if (error.name === 'NotAllowedError') {\n        errorMessage = 'マイクの使用が拒否されました。ブラウザの設定でマイクアクセスを許可してください。\\n\\niPhoneの場合：\\n1. Safari設定 > プライバシーとセキュリティ > マイク\\n2. このサイトを許可に設定';\n      } else if (error.name === 'NotFoundError') {\n        errorMessage = 'マイクが見つかりません。';\n      } else if (error.name === 'NotSupportedError') {\n        errorMessage = 'お使いのブラウザは録音機能をサポートしていません。';\n      } else if (error.message) {\n        errorMessage = error.message;\n      }\n      \n      alert(errorMessage);\n      return false;\n    }\n  };\n\n  // HTTPS接続チェック（iOSでの録音に必要）\n  const checkHTTPS = () => {\n    if (window.location.protocol !== 'https:' && window.location.hostname !== 'localhost' && window.location.hostname !== '127.0.0.1') {\n      return false;\n    }\n    return true;\n  };\n\n  // 音声レベル監視関数\n  const monitorAudioLevel = (analyserNode) => {\n    const bufferLength = analyserNode.frequencyBinCount;\n    const dataArray = new Uint8Array(bufferLength);\n    \n    console.log('音声レベル監視開始 - bufferLength:', bufferLength);\n    \n    const updateLevel = () => {\n      if (!isRecording) {\n        console.log('録音停止のため音声レベル監視終了');\n        return;\n      }\n      \n      // 時間領域データを取得（周波数領域ではなく）\n      analyserNode.getByteTimeDomainData(dataArray);\n      \n      // デバッグ用：最初の10サンプルをログ出力（最初の数秒のみ）\n      if (Math.random() < 0.01) { // 1%の確率でログ出力\n        console.log('音声データサンプル:', Array.from(dataArray.slice(0, 10)));\n      }\n      \n      // RMS（二乗平均平方根）を計算\n      let sum = 0;\n      for (let i = 0; i < bufferLength; i++) {\n        const sample = (dataArray[i] - 128) / 128; // -1 to 1の範囲に正規化\n        sum += sample * sample;\n      }\n      const rms = Math.sqrt(sum / bufferLength);\n      \n      // デシベルに変換して0-100の範囲にマッピング\n      const db = 20 * Math.log10(rms + 0.0001); // 0.0001は-∞を防ぐため\n      const level = Math.max(0, Math.min(100, ((db + 60) / 60) * 100)); // -60dBを0%、0dBを100%に\n      \n      // デバッグ用：レベルをログ出力（時々）\n      if (Math.random() < 0.01) { // 1%の確率でログ出力\n        console.log('音声レベル - RMS:', rms, 'dB:', db, 'Level:', level);\n      }\n      \n      setAudioLevel(level);\n      \n      if (isRecording) {\n        animationFrameRef.current = requestAnimationFrame(updateLevel);\n      }\n    };\n    \n    updateLevel();\n  };\n\n  return (\n    <div className=\"sound-collection\">\n      <h2>🎤 音あつめページ</h2>\n      <p>身の回りにある音を録音したり、音ファイルをアップロードして音素材を集めましょう！</p>\n      \n      <div className=\"collection-actions\">\n        <div className=\"recording-section card\">\n          <h3>🎙️ 音を録音する</h3>\n          \n          {/* iOS用の説明 */}\n          <div className=\"ios-notice\">\n            <p>📱 <strong>iPhone/iPadをお使いの方へ：</strong></p>\n            <p>録音ボタンを押すとマイクの使用許可を求めるダイアログが表示されます。「許可」を選択してください。</p>\n            <p>ダイアログが表示されない場合は、Safari設定 → プライバシーとセキュリティ → マイク でこのサイトを許可してください。</p>\n          </div>\n          \n          <div className=\"recording-controls\">\n            {!isRecording ? (\n              <button \n                className=\"button-primary large-button record-btn\"\n                onClick={startRecording}\n              >\n                🔴 録音開始\n              </button>\n            ) : (\n              <button \n                className=\"button-secondary large-button stop-btn\"\n                onClick={stopRecording}\n              >\n                ⏹️ 録音停止\n              </button>\n            )}\n          </div>\n          {isRecording && (\n            <div className=\"recording-status\">\n              <div className=\"recording-indicator\">\n                <div className=\"pulse-dot\"></div>\n                録音中...\n              </div>\n              <div className=\"audio-level-meter\">\n                <div className=\"audio-level-label\">音声入力レベル:</div>\n                <div className=\"audio-level-bar\">\n                  <div \n                    className=\"audio-level-fill\" \n                    style={{ width: `${audioLevel}%` }}\n                  ></div>\n                </div>\n                <div className=\"audio-level-value\">{Math.round(audioLevel)}%</div>\n              </div>\n            </div>\n          )}\n        </div>\n\n        <div className=\"upload-section card\">\n          <h3>📁 音ファイルをアップロード</h3>\n          <button \n            className=\"button-secondary large-button\"\n            onClick={() => fileInputRef.current?.click()}\n          >\n            📂 ファイルを選択\n          </button>\n          <input\n            ref={fileInputRef}\n            type=\"file\"\n            accept=\"audio/*\"\n            onChange={handleFileUpload}\n            style={{ display: 'none' }}\n          />\n        </div>\n      </div>\n\n      {currentRecording && (\n        <RecordingEditor \n          recording={currentRecording}\n          onSave={saveRecording}\n          onCancel={() => setCurrentRecording(null)}\n        />\n      )}\n\n      <div className=\"recent-recordings\">\n        <h3>📝 最近録音した音</h3>\n        {recordings.length === 0 ? (\n          <p className=\"no-recordings\">まだ録音した音がありません。上の録音ボタンから始めましょう！</p>\n        ) : (\n          <div className=\"recordings-grid\">\n            {recordings.map(recording => (\n              <SoundCard key={recording.id} recording={recording} />\n            ))}\n          </div>\n        )}\n      </div>\n    </div>\n  );\n};\n\nconst RecordingEditor = ({ recording, onSave, onCancel }) => {\n  const [name, setName] = useState(recording.name);\n  const [tagInput, setTagInput] = useState('');\n  const [tags, setTags] = useState(recording.tags);\n\n  const addTag = () => {\n    if (tagInput.trim() && !tags.includes(tagInput.trim())) {\n      setTags([...tags, tagInput.trim()]);\n      setTagInput('');\n    }\n  };\n\n  const removeTag = (tagToRemove) => {\n    setTags(tags.filter(tag => tag !== tagToRemove));\n  };\n\n  const handleKeyPress = (e) => {\n    if (e.key === 'Enter') {\n      addTag();\n    }\n  };\n\n  return (\n    <div className=\"recording-editor card\">\n      <h3>✏️ 音に名前をつけよう</h3>\n      \n      <audio \n        controls \n        src={recording.url} \n        className=\"audio-preview\"\n        onError={(e) => {\n          console.error('音声プレビューの読み込みエラー:', e);\n        }}\n      />\n      \n      <div className=\"form-group\">\n        <label htmlFor=\"soundName\">音の名前:</label>\n        <input\n          id=\"soundName\"\n          type=\"text\"\n          value={name}\n          onChange={(e) => setName(e.target.value)}\n          placeholder=\"例: ピアノの音、雨の音\"\n          className=\"sound-name-input\"\n        />\n      </div>\n\n      <div className=\"form-group\">\n        <label htmlFor=\"soundTags\">タグ:</label>\n        <div className=\"tag-input-container\">\n          <input\n            id=\"soundTags\"\n            type=\"text\"\n            value={tagInput}\n            onChange={(e) => setTagInput(e.target.value)}\n            onKeyPress={handleKeyPress}\n            placeholder=\"例: 楽器、自然\"\n            className=\"tag-input\"\n          />\n          <button onClick={addTag} className=\"add-tag-btn\">追加</button>\n        </div>\n        \n        {tags.length > 0 && (\n          <div className=\"tags-display\">\n            {tags.map(tag => (\n              <span key={tag} className=\"tag\">\n                {tag}\n                <button onClick={() => removeTag(tag)} className=\"remove-tag\">×</button>\n              </span>\n            ))}\n          </div>\n        )}\n      </div>\n\n      <div className=\"editor-actions\">\n        <button \n          onClick={() => onSave(name, tags)}\n          className=\"button-primary\"\n          disabled={!name.trim()}\n        >\n          💾 保存\n        </button>\n        <button onClick={onCancel} className=\"button-secondary\">\n          ❌ キャンセル\n        </button>\n      </div>\n    </div>\n  );\n};\n\nconst SoundCard = ({ recording }) => {\n  return (\n    <div className=\"sound-card\">\n      <div className=\"sound-info\">\n        <h4>{recording.name}</h4>\n        <p className=\"sound-date\">\n          {new Date(recording.createdAt).toLocaleDateString('ja-JP')}\n        </p>\n        {recording.tags.length > 0 && (\n          <div className=\"sound-tags\">\n            {recording.tags.map(tag => (\n              <span key={tag} className=\"tag small\">{tag}</span>\n            ))}\n          </div>\n        )}\n      </div>\n      <audio \n        controls \n        src={recording.url}\n        onError={(e) => {\n          console.error('音声カードの読み込みエラー:', e, 'recording:', recording.name);\n        }}\n      />\n    </div>\n  );\n};\n\nexport default SoundCollection;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}